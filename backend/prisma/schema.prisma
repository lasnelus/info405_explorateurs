generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model Guardian {
  id             String        @id                   @default(cuid())
  email          String       @unique
  password       String

  firstName      String
  lastName       String

  role           Role          @default(GUARDIAN)

  families       Family[]

  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
}

model Family {
  id             String        @id                   @default(cuid())
  name           String

  guardians      Guardian[]
  childs          Child[]

  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
}

model Child {
  id             String        @id                   @default(cuid())

  firstName      String
  lastName       String

  families       Family[]
  slots          Slot[]
  queues         Queue[]

  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
}

enum QueueState {
  PENDING
  ACCEPTED
  TIMEOUT
}

model Queue {
  id             String        @id                   @default(cuid())

  child          Child         @relation(fields: [childId], references: [id], onDelete: Cascade)
  childId        String

  periode        Periode       @relation(fields: [periodeId], references: [id], onDelete: Cascade)
  periodeId      String

  state          QueueState

  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
}

model Slot {
  id             String        @id                   @default(cuid())

  child          Child         @relation(fields: [childId], references: [id], onDelete: Cascade)
  childId        String

  periode        Periode       @relation(fields: [periodeId], references: [id], onDelete: Cascade)
  periodeId      String

  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
}

model Periode {
  id             String        @id                   @default(cuid())

  ageMin         Int
  ageMax         Int

  firstDay       DateTime      @db.Date
  lastDay        DateTime      @db.Date

  slots          Slot[]
  queues         Queue[]
}

enum Role {
  OWNER
  INSTRUCTOR
  GUARDIAN
}
model Manager {
  id             String        @id                   @default(cuid())
  email          String        @unique
  password       String

  firstName      String
  lastName       String

  role           Role          @default(INSTRUCTOR)

  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
}